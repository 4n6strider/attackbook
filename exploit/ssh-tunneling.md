---
description: >-
  SSH tunneling can be used to pivot and access systems that are inaccessible
  directly from your client machine.
---

# SSH Tunneling

## Basics

```bash
 ssh $user@$remoteserver
 scp $local_file $user@$remoteserver:/path/$remote_file
 sftp $user@$remoteserver
 
 #copy local folder to remote
 tar -cvj /$local_folder | ssh $remoteserver "tar -xj -C /$remote_folder"
 
 #copy remote folder to local
 ssh $user@$remoteserver "tar -jcf - /$folder" > $folder.tar.bz2
```

## Local Port Forwarding

```bash
ssh -L $local_bind_address:$local_bind_port:$target_host:$target_port $user@$proxy_host

Example A:
---------

ssh -L 8888:127.0.0.1:80 admin@workstation.lan

[client:8888] <=====> [workstation.lan:22]<->[:80]

In this example, client can connect to workstation.lan on TCP/22 but cannot browse the webserver on TCP/80.
Open a browser on client and connect to http://localhost:8888 and you will be browsing the web server on workstation.lan.
You could also open this up to other clients on your network if desired:

ssh -L *:8888:127.0.0.1:80 admin@workstation.lan

[other_client] <-----> [client:8888] <----> [workstation.lan:22]<->[:80]

Example B:
---------

ssh -L 8888:server.lan:80 admin@workstation.lan

[client] <=====> [workstation.lan] <-----> [server.lan]<->[:80]

In this example, client can connect to workstation.lan but cannot browse the webserver on server.lan.
Open a browser on client and connect to http://localhost:8888 and you will be browsing the web server on server.lan.
The http requests on server.lan will appear to come from workstation.lan.
```

#### Dynamic Port Forwarding

```bash
ssh -D $interfaces:$port $user@$proxyhost

 # -C: enable compression
 # -n: no remote command
 # -f: fork
 # -N: no shell
 # -D: dynamic mode

#run a socks5 proxy on all interfaces with local "proxy" user
ssh -CnfND *:8888 proxy@localhost

```

## Remote Port Forwarding

```bash
ssh -R :80:127.0.0.1:80 10.1.1.20

```

